version: 2.1

jobs:
  build:
    docker:
      - image: cimg/base:stable
    steps:
      - run:
          name: fail command
          command: sleep 30

  deploy:
    docker:
      - image: cimg/base:stable
    steps:
      - run: 
          name: deploy
          command: echo "It shoud be success"
      - run:
          name: run when deploy workflow fail
          command: echo "It is on_fail step of deploy workflow"
          when: always

workflows:
  build-permission-deploy:
    jobs:
      - build
      - deploy:
          requires:
            - build